#!/bin/bash
set -e

XDG_DATA_HOME="${XDG_DATA_HOME:-$HOME/.local/share}"
CARGO_HOME="${CARGO_HOME:-$XDG_DATA_HOME/cargo}"
RUSTUP_HOME="${RUSTUP_HOME:-$XDG_DATA_HOME/rustup}"

# Migrate legacy defaults (~/.cargo, ~/.rustup) into XDG locations.
if [ -d "$HOME/.cargo" ] && [ ! -e "$CARGO_HOME" ]; then
  mkdir -p "$(dirname "$CARGO_HOME")"
  mv "$HOME/.cargo" "$CARGO_HOME"
fi

if [ -d "$HOME/.rustup" ] && [ ! -e "$RUSTUP_HOME" ]; then
  mkdir -p "$(dirname "$RUSTUP_HOME")"
  mv "$HOME/.rustup" "$RUSTUP_HOME"
fi
